function z(){const u="restaurantOrder";let g=!1,v=[];function c(e,t,n,o){e&&(e.addEventListener(t,n,o),v.push({element:e,type:t,listener:n,options:o}))}function w(){v.forEach(({element:e,type:t,listener:n,options:o})=>{e.removeEventListener(t,n,o)}),v=[]}function B(){return Date.now().toString(36)+Math.random().toString(36).substring(2,5)}function h(){try{if(typeof localStorage>"u")return[];const e=localStorage.getItem(u)||"[]",t=JSON.parse(e),n=Date.now(),o=t.filter(r=>r&&typeof r.expiresAt=="number"&&r.expiresAt>n).map(r=>(r.id||(r.id=B()),r));return o.length!==t.length&&localStorage.setItem(u,JSON.stringify(o)),o}catch(e){return console.error("Error parsing order data:",e),[]}}function N(e){try{localStorage.setItem(u,JSON.stringify(e)),document.dispatchEvent(new CustomEvent("orderUpdated"))}catch(t){console.error("Error saving order data:",t)}}function b(){return document.documentElement.dir==="rtl"}function k(e,t){const n=t?"درهم":"DH",o=typeof e=="string"?parseFloat(e):e;return`${(isNaN(o)?0:o).toFixed(2)}${n}`}const s=function(){const e=h(),t=document.getElementById("order-button"),n=document.getElementById("order-badge");!t||!n||(e.length>0?(t.classList.remove("hidden"),n.textContent=e.length.toString(),n.classList.remove("hidden")):(t.classList.add("hidden"),n.classList.add("hidden")))};function m(){const e=h(),t=document.getElementById("order-content");if(!t)return;const n=document.createDocumentFragment();if(e.length===0){const a=document.createElement("p");a.className="text-center text-red-500",a.textContent=b()?"لم يتم طلب أي شيئ.":"0 Commandes - 0 Pedidos - 0 Orders",n.appendChild(a),t.innerHTML="",t.appendChild(n);return}let o=0;e.forEach(a=>{const x=parseFloat(a.price.replace(/[^0-9.-]+/g,""));o+=isNaN(x)?0:x;const f=document.createElement("div");f.className="flex justify-between items-center text-black dark:text-white py-2 border-b border-gray-100 dark:border-gray-700";const y=document.createElement("span");y.className="flex-grow",y.textContent=a.name,f.appendChild(y);const L=document.createElement("span");L.className="font-medium mx-2",L.textContent=a.price,f.appendChild(L);const l=document.createElement("button");l.className="text-red-500 hover:text-red-700 ml-2 delete-item-btn",l.dataset.id=a.id,l.setAttribute("aria-label","Remove item"),l.innerHTML=`
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd" />
          </svg>
        `,l.addEventListener("click",function(O){O.preventDefault(),O.stopPropagation();const S=this.getAttribute("data-id");S&&M(S)}),f.appendChild(l),n.appendChild(f)});const r=b(),d=r?"المجموع":"Total",i=document.createElement("div");i.className="mt-4 pt-4 px-3 flex justify-between items-center text-xl text-black dark:text-accent font-bold";const C=document.createElement("span");C.textContent=d,i.appendChild(C);const I=document.createElement("span");I.textContent=k(o,r),i.appendChild(I),n.appendChild(i),t.innerHTML="",t.appendChild(n)}function P(){const e=document.getElementById("order-overlay");if(!e)return;!e.classList.contains("hidden")?e.classList.add("hidden"):(e.classList.remove("hidden"),m())}function M(e){const n=h().filter(o=>o.id!==e);N(n),s(),m()}function D(){s();const e=document.getElementById("order-overlay");e&&!e.classList.contains("hidden")&&m()}function T(){c(window,"storage",function(t){if(t.key===u){s();const o=document.getElementById("order-overlay");o&&!o.classList.contains("hidden")&&m()}})}function H(){const e=localStorage.setItem;localStorage.setItem=function(t,n){e.apply(this,[t,n]),t===u&&setTimeout(()=>{s()},0)}}function V(){const e=document.getElementById("order-button");c(e,"click",function(d){d.preventDefault(),P()});const t=document.getElementById("close-modal-button");c(t,"click",function(d){d.preventDefault(),d.stopPropagation();const i=document.getElementById("order-overlay");i&&i.classList.add("hidden")});const n=document.getElementById("order-overlay");c(n,"click",function(d){d.target===this&&this.classList.add("hidden")});const o=document.getElementById("order-modal");c(o,"click",function(d){d.stopPropagation()}),c(document,"orderUpdated",D),T();const r=window.setInterval(()=>{s()},2e3);window.orderComponentPollInterval=r}function p(){g||(w(),H(),V(),s(),g=!0)}function E(){w(),window.orderComponentPollInterval&&(clearInterval(window.orderComponentPollInterval),window.orderComponentPollInterval=void 0),g=!1}document.addEventListener("DOMContentLoaded",p),document.addEventListener("astro:page-load",p),document.addEventListener("astro:before-swap",E),document.addEventListener("turbolinks:load",p),document.addEventListener("turbolinks:before-cache",E),window.addEventListener("pageshow",function(e){e.persisted&&p()}),window.addEventListener("beforeunload",E),document.readyState!=="loading"&&p(),window.orderReceiptComponent={updateBadge:s,populateContent:m}}z();
